# 剪一剪 - 专业安装包创建指南

## 📦 方式2: 专业安装包 (Inno Setup)

使用 Inno Setup 6 创建标准的 Windows 安装程序

## 🎯 概述

**Inno Setup** 是 Windows 上最流行的免费安装程序制作工具，生成的安装程序：
- ✅ 符合 Windows 安装标准
- ✅ 现代化的安装向导界面
- ✅ 支持多语言
- ✅ 自动创建桌面快捷方式
- ✅ 自动创建开始菜单项
- ✅ 包含卸载程序
- ✅ 支持静默安装

## 📋 完整操作步骤

### 步骤1: 下载安装 Inno Setup 6

**方式A: 手动下载**
1. 打开浏览器访问：https://jrsoftware.org/isdl.php
2. 点击 "Download Inno Setup 6"
3. 下载类似 `innosetup-6.x.x.exe` 的文件
4. 安装到默认路径：`C:\Program Files (x86)\Inno Setup 6\`

**方式B: 使用脚本（需要手动下载）**
```
剪一剪\tools\下载InnoSetup.bat
```

### 步骤2: 编译安装包

**自动编译（推荐）**
```
双击运行：剪一剪\tools\编译安装包.bat
```

**手动编译**
```cmd
cd 剪一剪\releases\v2.0\jianyijian_v2.0_20251029_124038\

# 方式1：使用完整路径
"C:\Program Files (x86)\Inno Setup 6\ISCC.exe" setup.iss

# 方式2：添加到PATH后
iscc setup.iss
```

### 步骤3: 获取安装程序

编译成功后，会在当前目录生成：
```
剪一剪_V2.0_Setup.exe
```

这就是最终的**专业安装包**！

## 📁 项目文件结构

```
剪一剪/
├── releases/
│   └── v2.0/
│       └── jianyijian_v2.0_20251029_124038/
│           ├── jianyijian.exe              (120 MB)
│           ├── setup.iss                   (Inno Setup脚本)
│           ├── README.txt                  (使用说明)
│           ├── 启动剪一剪.bat              (启动脚本)
│           └── 其他文档...
├── tools/
│   ├── 编译安装包.bat                      (编译脚本)
│   ├── 下载InnoSetup.bat                  (下载脚本)
│   └── 手动安装InnoSetup.txt              (详细说明)
└── 专业安装包说明.md                       (本文件)
```

## ⚙️ setup.iss 配置说明

### 主要配置项

```ini
[Setup]
AppName=剪一剪                    ; 应用名称
AppVersion=2.0                   ; 版本号
DefaultDirName={autopf}\剪一剪    ; 默认安装路径
DefaultGroupName=剪一剪          ; 开始菜单组名
OutputBaseFilename=剪一剪_V2.0_Setup  ; 输出文件名
WizardStyle=modern               ; 现代化界面
```

### 安装选项

```ini
[Tasks]
Name: desktopicon        ; 创建桌面快捷方式
Name: quicklaunchicon    ; 创建快速启动栏图标
Name: addtopath          ; 添加到PATH环境变量
```

### 包含文件

```ini
[Files]
Source: jianyijian.exe           ; 主程序
Source: README.txt               ; 说明文档
Source: 启动剪一剪.bat           ; 启动脚本
```

### 快捷方式

```ini
[Icons]
Name: "{group}\剪一剪"           ; 开始菜单
Name: "{autodesktop}\剪一剪"     ; 桌面快捷方式
```

## 🎨 界面自定义

### 添加图标

如需添加应用图标：

1. 准备图标文件 `app_icon.png`
2. 复制到发布目录
3. 编辑 `setup.iss` 取消注释：
   ```ini
   SetupIconFile=assets\app_icon.png
   WizardImageFile=@AGI.png
   WizardSmallImageFile=assets\app_icon.png
   ```

### 修改安装界面

```ini
WizardImageFile=my_banner.png     ; 安装向导横幅
WizardSmallImageFile=my_icon.ico  ; 向导小图标
```

### 修改安装路径

```ini
DefaultDirName={autopf}\我的软件\剪一剪
```

## 🚀 高级功能

### 静默安装

**完全静默**：
```cmd
剪一剪_V2.0_Setup.exe /SILENT /NORESTART /SUPPRESSMSGBOXES
```

**静默但显示进度**：
```cmd
剪一剪_V2.0_Setup.exe /VERYSILENT /NORESTART
```

**带日志的静默安装**：
```cmd
剪一剪_V2.0_Setup.exe /SILENT /LOG=install.log
```

### 自定义安装选项

在 `[Run]` 段添加：
```ini
[Run]
Filename: "{cmd}"; Parameters: "/c echo 安装完成"; Flags: runascurrentuser
```

### 卸载时清理

```ini
[UninstallDelete]
Type: filesandordirs; Name: "{app}\config"    ; 删除配置目录
Type: files; Name: "{app}\*.log"              ; 删除日志文件
```

## 📊 安装包特性

### ✅ 完整功能

1. **安装向导**
   - 欢迎页面
   - 许可证协议
   - 安装路径选择
   - 组件选择（桌面图标等）
   - 安装进度
   - 完成页面

2. **快捷方式**
   - 开始菜单 → 程序 → 剪一剪
   - 桌面快捷方式
   - 快速启动栏图标（Win7及以下）
   - 卸载程序快捷方式

3. **注册表项**
   - 添加/删除程序列表
   - PATH环境变量（可选）
   - 文件关联（可选）

4. **卸载功能**
   - 完整的卸载程序
   - 自动清理快捷方式
   - 可选清理用户数据

### 📈 安装程序大小

- **原始文件**: 120 MB (jianyijian.exe)
- **安装包**: ~122 MB (包含安装程序自身)
- **压缩率**: 约 99% (LZMA压缩)

## 🔧 故障排除

### Q1: 编译失败，提示找不到文件
**解决方案**：
- 确保在正确目录执行：`jianyijian_v2.0_20251029_124038\`
- 检查 `jianyijian.exe` 文件是否存在
- 检查路径中是否包含中文或特殊字符

### Q2: 生成的安装包无法运行
**解决方案**：
- 检查 `jianyijian.exe` 是否完整
- 尝试在不同电脑上测试
- 检查防病毒软件是否拦截

### Q3: 快捷方式创建失败
**解决方案**：
- 以管理员身份运行安装程序
- 检查用户权限
- 手动创建快捷方式

### Q4: 卸载不干净
**解决方案**：
- 检查 `[UninstallDelete]` 段配置
- 手动删除残留文件
- 清理注册表项

### Q5: 中文显示乱码
**解决方案**：
- 确保 `.iss` 文件编码为 UTF-8
- 使用 Inno Setup 6 (支持 Unicode)
- 检查系统区域设置

## 🎓 最佳实践

### 对开发者

1. **版本管理**
   - 每次更新EXE后重新编译
   - 使用时间戳命名安装包
   - 保留历史版本

2. **测试流程**
   - 在干净的系统上测试
   - 测试安装和卸载
   - 测试静默安装

3. **签名**
   - 对EXE进行代码签名
   - 避免Windows安全警告
   - 使用代码签名证书

### 对用户

1. **分发**
   - 压缩为 zip 文件
   - 提供校验和 (SHA256)
   - 附带安装说明

2. **系统要求**
   - Windows 7/8/10/11
   - 管理员权限（推荐）
   - 200 MB 可用空间

## 📝 常用命令参考

### 编译命令
```cmd
iscc setup.iss                    # 标准编译
iscc /O+ setup.iss                # 优化编译
iscc /F+ setup.iss                # 强制重新编译
```

### 静默安装
```cmd
/SILENT                           # 静默安装
/VERYSILENT                       # 完全静默
/NORESTART                        # 不重启
/SUPPRESSMSGBOXES                 # 隐藏所有消息框
/LOG=filename.log                 # 生成日志
/D=安装路径                       # 指定安装目录
```

### 卸载命令
```cmd
/uninstall                        # 标准卸载
/SILENT /NORESTART                # 静默卸载
```

## 🎉 成功案例

完成编译后，您将得到：

```
剪一剪_V2.0_Setup.exe    (专业安装程序)
```

**分发方法**：
1. 上传到网盘供下载
2. 发送到用户邮箱
3. 上传到官网下载页
4. 制作光盘或U盘

**用户体验**：
1. 双击运行安装程序
2. 按照向导完成安装
3. 在桌面找到快捷方式
4. 双击即可使用

## 📞 支持

如需帮助，请查看：
- `工具\手动安装InnoSetup.txt` - 详细安装指南
- `INSTALLATION_GUIDE.md` - 完整安装指南
- `打包说明.md` - 打包相关说明

---

**创建时间**: 2025-10-29 13:15
**状态**: ✅ 配置完成，等待编译
**下一步**: 下载安装Inno Setup → 执行编译
